const { MongoClient } = require('mongodb');

const uri = 'mongodb://localhost:27017';
const dbName = 'ises_isea';

const materialesFontaneria = [
    // TUBER√çAS Y ACCESORIOS
    {
        codigo: 'TUB-PVC-001',
        nombre: 'Tuber√≠a PVC 1/2" x 6m',
        descripcion: 'Tuber√≠a PVC presi√≥n 1/2 pulgada, longitud 6 metros, para redes de agua potable',
        categoria: 'tuberias',
        unidad: 'unidad',
        cantidad: 150,
        stockMinimo: 30,
        stockMaximo: 200,
        precioUnitario: 12500,
        proveedor: 'Pavco Colombia',
        ubicacion: 'Bodega A - Estante 1',
        activo: true,
    },
    {
        codigo: 'TUB-PVC-002',
        nombre: 'Tuber√≠a PVC 3/4" x 6m',
        descripcion: 'Tuber√≠a PVC presi√≥n 3/4 pulgada, longitud 6 metros',
        categoria: 'tuberias',
        unidad: 'unidad',
        cantidad: 120,
        stockMinimo: 25,
        stockMaximo: 180,
        precioUnitario: 18500,
        proveedor: 'Pavco Colombia',
        ubicacion: 'Bodega A - Estante 1',
        activo: true,
    },
    {
        codigo: 'TUB-PVC-003',
        nombre: 'Tuber√≠a PVC 1" x 6m',
        descripcion: 'Tuber√≠a PVC presi√≥n 1 pulgada, longitud 6 metros',
        categoria: 'tuberias',
        unidad: 'unidad',
        cantidad: 100,
        stockMinimo: 20,
        stockMaximo: 150,
        precioUnitario: 25000,
        proveedor: 'Pavco Colombia',
        ubicacion: 'Bodega A - Estante 2',
        activo: true,
    },
    {
        codigo: 'TUB-PVC-004',
        nombre: 'Tuber√≠a PVC 2" x 6m',
        descripcion: 'Tuber√≠a PVC presi√≥n 2 pulgadas, longitud 6 metros',
        categoria: 'tuberias',
        unidad: 'unidad',
        cantidad: 80,
        stockMinimo: 15,
        stockMaximo: 120,
        precioUnitario: 45000,
        proveedor: 'Pavco Colombia',
        ubicacion: 'Bodega A - Estante 2',
        activo: true,
    },
    {
        codigo: 'TUB-PVC-005',
        nombre: 'Tuber√≠a PVC 3" x 6m',
        descripcion: 'Tuber√≠a PVC presi√≥n 3 pulgadas, longitud 6 metros',
        categoria: 'tuberias',
        unidad: 'unidad',
        cantidad: 60,
        stockMinimo: 10,
        stockMaximo: 100,
        precioUnitario: 75000,
        proveedor: 'Pavco Colombia',
        ubicacion: 'Bodega A - Estante 3',
        activo: true,
    },

    // CODOS Y UNIONES
    {
        codigo: 'COD-PVC-001',
        nombre: 'Codo PVC 90¬∞ 1/2"',
        descripcion: 'Codo PVC 90 grados de 1/2 pulgada para conexiones',
        categoria: 'accesorios',
        unidad: 'unidad',
        cantidad: 500,
        stockMinimo: 100,
        stockMaximo: 800,
        precioUnitario: 1200,
        proveedor: 'Pavco Colombia',
        ubicacion: 'Bodega B - Caj√≥n 1',
        activo: true,
    },
    {
        codigo: 'COD-PVC-002',
        nombre: 'Codo PVC 90¬∞ 3/4"',
        descripcion: 'Codo PVC 90 grados de 3/4 pulgada',
        categoria: 'accesorios',
        unidad: 'unidad',
        cantidad: 450,
        stockMinimo: 90,
        stockMaximo: 700,
        precioUnitario: 1800,
        proveedor: 'Pavco Colombia',
        ubicacion: 'Bodega B - Caj√≥n 1',
        activo: true,
    },
    {
        codigo: 'COD-PVC-003',
        nombre: 'Codo PVC 90¬∞ 1"',
        descripcion: 'Codo PVC 90 grados de 1 pulgada',
        categoria: 'accesorios',
        unidad: 'unidad',
        cantidad: 400,
        stockMinimo: 80,
        stockMaximo: 600,
        precioUnitario: 2500,
        proveedor: 'Pavco Colombia',
        ubicacion: 'Bodega B - Caj√≥n 2',
        activo: true,
    },
    {
        codigo: 'UNI-PVC-001',
        nombre: 'Uni√≥n PVC 1/2"',
        descripcion: 'Uni√≥n universal PVC de 1/2 pulgada',
        categoria: 'accesorios',
        unidad: 'unidad',
        cantidad: 350,
        stockMinimo: 70,
        stockMaximo: 500,
        precioUnitario: 2200,
        proveedor: 'Pavco Colombia',
        ubicacion: 'Bodega B - Caj√≥n 3',
        activo: true,
    },
    {
        codigo: 'UNI-PVC-002',
        nombre: 'Uni√≥n PVC 3/4"',
        descripcion: 'Uni√≥n universal PVC de 3/4 pulgada',
        categoria: 'accesorios',
        unidad: 'unidad',
        cantidad: 300,
        stockMinimo: 60,
        stockMaximo: 450,
        precioUnitario: 3200,
        proveedor: 'Pavco Colombia',
        ubicacion: 'Bodega B - Caj√≥n 3',
        activo: true,
    },

    // V√ÅLVULAS Y LLAVES
    {
        codigo: 'VAL-BOL-001',
        nombre: 'V√°lvula de Bola 1/2"',
        descripcion: 'V√°lvula de bola de 1/2 pulgada, bronce, paso total',
        categoria: 'valvulas',
        unidad: 'unidad',
        cantidad: 200,
        stockMinimo: 40,
        stockMaximo: 300,
        precioUnitario: 15000,
        proveedor: 'Grival',
        ubicacion: 'Bodega C - Estante 1',
        activo: true,
    },
    {
        codigo: 'VAL-BOL-002',
        nombre: 'V√°lvula de Bola 3/4"',
        descripcion: 'V√°lvula de bola de 3/4 pulgada, bronce, paso total',
        categoria: 'valvulas',
        unidad: 'unidad',
        cantidad: 180,
        stockMinimo: 35,
        stockMaximo: 280,
        precioUnitario: 22000,
        proveedor: 'Grival',
        ubicacion: 'Bodega C - Estante 1',
        activo: true,
    },
    {
        codigo: 'VAL-BOL-003',
        nombre: 'V√°lvula de Bola 1"',
        descripcion: 'V√°lvula de bola de 1 pulgada, bronce, paso total',
        categoria: 'valvulas',
        unidad: 'unidad',
        cantidad: 150,
        stockMinimo: 30,
        stockMaximo: 250,
        precioUnitario: 35000,
        proveedor: 'Grival',
        ubicacion: 'Bodega C - Estante 2',
        activo: true,
    },
    {
        codigo: 'VAL-CHE-001',
        nombre: 'V√°lvula Check 1/2"',
        descripcion: 'V√°lvula check (anti-retorno) de 1/2 pulgada, bronce',
        categoria: 'valvulas',
        unidad: 'unidad',
        cantidad: 120,
        stockMinimo: 25,
        stockMaximo: 200,
        precioUnitario: 18000,
        proveedor: 'Grival',
        ubicacion: 'Bodega C - Estante 3',
        activo: true,
    },
    {
        codigo: 'VAL-CHE-002',
        nombre: 'V√°lvula Check 3/4"',
        descripcion: 'V√°lvula check (anti-retorno) de 3/4 pulgada, bronce',
        categoria: 'valvulas',
        unidad: 'unidad',
        cantidad: 100,
        stockMinimo: 20,
        stockMaximo: 180,
        precioUnitario: 25000,
        proveedor: 'Grival',
        ubicacion: 'Bodega C - Estante 3',
        activo: true,
    },

    // MEDIDORES Y ACCESORIOS
    {
        codigo: 'MED-AGU-001',
        nombre: 'Medidor de Agua 1/2" Residencial',
        descripcion: 'Medidor de agua potable 1/2 pulgada, clase B, uso residencial',
        categoria: 'medidores',
        unidad: 'unidad',
        cantidad: 80,
        stockMinimo: 15,
        stockMaximo: 150,
        precioUnitario: 85000,
        proveedor: 'Elster',
        ubicacion: 'Bodega D - Estante 1',
        activo: true,
    },
    {
        codigo: 'MED-AGU-002',
        nombre: 'Medidor de Agua 3/4" Comercial',
        descripcion: 'Medidor de agua potable 3/4 pulgada, clase C, uso comercial',
        categoria: 'medidores',
        unidad: 'unidad',
        cantidad: 50,
        stockMinimo: 10,
        stockMaximo: 100,
        precioUnitario: 125000,
        proveedor: 'Elster',
        ubicacion: 'Bodega D - Estante 1',
        activo: true,
    },
    {
        codigo: 'CAJ-MED-001',
        nombre: 'Caja para Medidor Pl√°stica',
        descripcion: 'Caja protectora para medidor de agua, pl√°stico resistente UV',
        categoria: 'accesorios',
        unidad: 'unidad',
        cantidad: 100,
        stockMinimo: 20,
        stockMaximo: 180,
        precioUnitario: 35000,
        proveedor: 'Plastigama',
        ubicacion: 'Bodega D - Estante 2',
        activo: true,
    },

    // LLAVES Y GRIFER√çA
    {
        codigo: 'LLA-LAV-001',
        nombre: 'Llave Lavamanos Cromada',
        descripcion: 'Llave para lavamanos, cromada, monomando, incluye desag√ºe',
        categoria: 'griferia',
        unidad: 'unidad',
        cantidad: 60,
        stockMinimo: 12,
        stockMaximo: 100,
        precioUnitario: 65000,
        proveedor: 'Corona',
        ubicacion: 'Bodega E - Estante 1',
        activo: true,
    },
    {
        codigo: 'LLA-DUC-001',
        nombre: 'Llave Ducha Cromada',
        descripcion: 'Llave para ducha, cromada, con regadera incluida',
        categoria: 'griferia',
        unidad: 'unidad',
        cantidad: 50,
        stockMinimo: 10,
        stockMaximo: 90,
        precioUnitario: 85000,
        proveedor: 'Corona',
        ubicacion: 'Bodega E - Estante 2',
        activo: true,
    },
    {
        codigo: 'LLA-JAR-001',
        nombre: 'Llave Jard√≠n 1/2"',
        descripcion: 'Llave de jard√≠n 1/2 pulgada, bronce cromado',
        categoria: 'griferia',
        unidad: 'unidad',
        cantidad: 80,
        stockMinimo: 15,
        stockMaximo: 130,
        precioUnitario: 28000,
        proveedor: 'Grival',
        ubicacion: 'Bodega E - Estante 3',
        activo: true,
    },

    // TANQUES Y ACCESORIOS
    {
        codigo: 'TAN-AGU-001',
        nombre: 'Tanque de Agua 500L',
        descripcion: 'Tanque de almacenamiento de agua 500 litros, polietileno',
        categoria: 'tanques',
        unidad: 'unidad',
        cantidad: 15,
        stockMinimo: 3,
        stockMaximo: 30,
        precioUnitario: 280000,
        proveedor: 'Eternit',
        ubicacion: 'Patio Exterior - Zona A',
        activo: true,
    },
    {
        codigo: 'TAN-AGU-002',
        nombre: 'Tanque de Agua 1000L',
        descripcion: 'Tanque de almacenamiento de agua 1000 litros, polietileno',
        categoria: 'tanques',
        unidad: 'unidad',
        cantidad: 10,
        stockMinimo: 2,
        stockMaximo: 20,
        precioUnitario: 450000,
        proveedor: 'Eternit',
        ubicacion: 'Patio Exterior - Zona A',
        activo: true,
    },
    {
        codigo: 'FLO-TAN-001',
        nombre: 'Flotador para Tanque',
        descripcion: 'Flotador autom√°tico para tanque de agua, 1/2 pulgada',
        categoria: 'accesorios',
        unidad: 'unidad',
        cantidad: 40,
        stockMinimo: 8,
        stockMaximo: 70,
        precioUnitario: 22000,
        proveedor: 'Grival',
        ubicacion: 'Bodega B - Caj√≥n 5',
        activo: true,
    },

    // HERRAMIENTAS Y CONSUMIBLES
    {
        codigo: 'PEG-PVC-001',
        nombre: 'Pegante PVC 1/4 Gal√≥n',
        descripcion: 'Pegante para tuber√≠a PVC, presentaci√≥n 1/4 gal√≥n',
        categoria: 'consumibles',
        unidad: 'unidad',
        cantidad: 80,
        stockMinimo: 15,
        stockMaximo: 150,
        precioUnitario: 18000,
        proveedor: 'Pavco Colombia',
        ubicacion: 'Bodega F - Estante 1',
        activo: true,
    },
    {
        codigo: 'TEF-ROL-001',
        nombre: 'Tefl√≥n en Rollo',
        descripcion: 'Cinta tefl√≥n para roscas, rollo de 12mm x 10m',
        categoria: 'consumibles',
        unidad: 'unidad',
        cantidad: 200,
        stockMinimo: 40,
        stockMaximo: 350,
        precioUnitario: 2500,
        proveedor: 'Varios',
        ubicacion: 'Bodega F - Caj√≥n 1',
        activo: true,
    },
    {
        codigo: 'LIM-PVC-001',
        nombre: 'Limpiador PVC 1/4 Gal√≥n',
        descripcion: 'Limpiador para tuber√≠a PVC antes de pegar',
        categoria: 'consumibles',
        unidad: 'unidad',
        cantidad: 60,
        stockMinimo: 12,
        stockMaximo: 100,
        precioUnitario: 15000,
        proveedor: 'Pavco Colombia',
        ubicacion: 'Bodega F - Estante 1',
        activo: true,
    },
    {
        codigo: 'SIL-TUB-001',
        nombre: 'Silicona para Tuber√≠as',
        descripcion: 'Silicona sellante para tuber√≠as, cartucho 300ml',
        categoria: 'consumibles',
        unidad: 'unidad',
        cantidad: 100,
        stockMinimo: 20,
        stockMaximo: 180,
        precioUnitario: 8500,
        proveedor: 'Varios',
        ubicacion: 'Bodega F - Caj√≥n 2',
        activo: true,
    },

    // ACCESORIOS SANITARIOS
    {
        codigo: 'INO-COM-001',
        nombre: 'Inodoro Completo Blanco',
        descripcion: 'Inodoro completo con tanque, color blanco, incluye tapa',
        categoria: 'sanitarios',
        unidad: 'unidad',
        cantidad: 20,
        stockMinimo: 4,
        stockMaximo: 40,
        precioUnitario: 320000,
        proveedor: 'Corona',
        ubicacion: 'Bodega G - Zona 1',
        activo: true,
    },
    {
        codigo: 'LAV-PED-001',
        nombre: 'Lavamanos con Pedestal',
        descripcion: 'Lavamanos con pedestal, color blanco, incluye grifer√≠a',
        categoria: 'sanitarios',
        unidad: 'unidad',
        cantidad: 15,
        stockMinimo: 3,
        stockMaximo: 30,
        precioUnitario: 180000,
        proveedor: 'Corona',
        ubicacion: 'Bodega G - Zona 2',
        activo: true,
    },

    // BOMBAS Y MOTORES
    {
        codigo: 'BOM-PER-001',
        nombre: 'Bomba Perif√©rica 1/2 HP',
        descripcion: 'Bomba perif√©rica 1/2 HP, para agua limpia, 110V',
        categoria: 'bombas',
        unidad: 'unidad',
        cantidad: 12,
        stockMinimo: 2,
        stockMaximo: 25,
        precioUnitario: 380000,
        proveedor: 'Pedrollo',
        ubicacion: 'Bodega H - Estante 1',
        activo: true,
    },
    {
        codigo: 'BOM-SUM-001',
        nombre: 'Bomba Sumergible 1 HP',
        descripcion: 'Bomba sumergible 1 HP, para pozos profundos, 220V',
        categoria: 'bombas',
        unidad: 'unidad',
        cantidad: 8,
        stockMinimo: 2,
        stockMaximo: 15,
        precioUnitario: 850000,
        proveedor: 'Pedrollo',
        ubicacion: 'Bodega H - Estante 2',
        activo: true,
    },

    // MATERIALES ESPECIALES
    {
        codigo: 'FIL-AGU-001',
        nombre: 'Filtro de Agua 10"',
        descripcion: 'Filtro de agua de 10 pulgadas, cartucho de sedimentos',
        categoria: 'filtros',
        unidad: 'unidad',
        cantidad: 50,
        stockMinimo: 10,
        stockMaximo: 90,
        precioUnitario: 25000,
        proveedor: 'Varios',
        ubicacion: 'Bodega I - Estante 1',
        activo: true,
    },
    {
        codigo: 'MAN-PVC-001',
        nombre: 'Manguera PVC 1/2" x 50m',
        descripcion: 'Manguera flexible PVC 1/2 pulgada, rollo de 50 metros',
        categoria: 'mangueras',
        unidad: 'rollo',
        cantidad: 30,
        stockMinimo: 6,
        stockMaximo: 60,
        precioUnitario: 95000,
        proveedor: 'Pavco Colombia',
        ubicacion: 'Bodega I - Estante 2',
        activo: true,
    },
    {
        codigo: 'ABR-TUB-001',
        nombre: 'Abrazadera Met√°lica 1/2"',
        descripcion: 'Abrazadera met√°lica para tuber√≠a 1/2 pulgada, con tornillo',
        categoria: 'accesorios',
        unidad: 'unidad',
        cantidad: 300,
        stockMinimo: 60,
        stockMaximo: 500,
        precioUnitario: 1500,
        proveedor: 'Varios',
        ubicacion: 'Bodega B - Caj√≥n 4',
        activo: true,
    },
];

async function seedMateriales() {
    const client = new MongoClient(uri);

    try {
        await client.connect();
        console.log('‚úÖ Conectado a MongoDB');

        const db = client.db(dbName);
        const materialesCollection = db.collection('materials');

        // Limpiar colecci√≥n existente (opcional)
        const deleteResult = await materialesCollection.deleteMany({});
        console.log(`üóëÔ∏è  Eliminados ${deleteResult.deletedCount} materiales existentes`);

        // Insertar nuevos materiales
        const result = await materialesCollection.insertMany(materialesFontaneria);
        console.log(`‚úÖ Insertados ${result.insertedCount} materiales de fontaner√≠a`);

        // Mostrar resumen por categor√≠a
        const categorias = await materialesCollection.aggregate([
            {
                $group: {
                    _id: '$categoria',
                    cantidad: { $sum: 1 },
                    valorTotal: { $sum: { $multiply: ['$cantidad', '$precioUnitario'] } },
                },
            },
            { $sort: { cantidad: -1 } },
        ]).toArray();

        console.log('\nüìä Resumen por categor√≠a:');
        categorias.forEach((cat) => {
            console.log(`   ${cat._id}: ${cat.cantidad} materiales - Valor: $${cat.valorTotal.toLocaleString('es-CO')}`);
        });

        const totalValor = categorias.reduce((sum, cat) => sum + cat.valorTotal, 0);
        console.log(`\nüí∞ Valor total del inventario: $${totalValor.toLocaleString('es-CO')} COP`);

    } catch (error) {
        console.error('‚ùå Error:', error);
    } finally {
        await client.close();
        console.log('\n‚úÖ Conexi√≥n cerrada');
    }
}

seedMateriales();
